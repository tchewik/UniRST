'''
Relation sets and mappings for the corpora annotated within the RST
'''

# General mapping for all corpora to the 18 coarse grained classes (Carlson et al. 2001)
mapping = {
    u'ahalbideratzea': 'Enablement',
    u'alderantzizko-baldintza': 'Condition',
    u'alternativa': 'Condition',
    u'analogy': 'Comparison',
    u'antitesia': 'Contrast',
    u'antithesis': 'Contrast',
    u'antítesis': 'Contrast',
    u'arazo-soluzioa': 'Topic-Comment',
    u'attribution': 'Attribution',
    u'attribution-negative': 'Attribution',
    u'aukera': 'Condition',
    u'background': 'Background',
    u'baldintza': 'Condition',
    u'bateratzea': 'Joint',
    u'birformulazioa': 'Summary',
    u'capacitación': 'Enablement',
    u'causa': 'Cause',
    u'cause': 'Cause',
    u'cause-result': 'Cause',
    u'circumstance': 'Background',
    u'circunstancia': 'Background',
    u'comment': 'Evaluation',
    u'comment-topic': 'Topic-Comment',
    u'comparison': 'Comparison',
    u'concesión': 'Contrast',
    u'concession': 'Contrast',
    u'conclusion': 'Evaluation',
    u'condición': 'Condition',
    u'condición-inversa': 'Condition',
    u'condition': 'Condition',
    u'conjunción': 'Joint',
    u'conjunction': 'Joint',
    u'consequence': 'Cause',
    u'contingency': 'Condition',
    u'contrast': 'Contrast',
    u'contraste': 'Contrast',
    u'definition': 'Elaboration',
    u'definitu-gabeko-erlazioa': 'Summary',
    u'disjunction': 'Joint',
    u'disjuntzioa': 'Joint',
    u'disyunción': 'Joint',
    u'e-elaboration': 'Elaboration',
    u'ebaluazioa': 'Evaluation',
    u'ebidentzia': 'Explanation',
    u'elaboración': 'Elaboration',
    u'elaboration': 'Elaboration',
    u'elaboration-additional': 'Elaboration',
    u'elaboration-general-specific': 'Elaboration',
    u'elaboration-object-attribute': 'Elaboration',
    u'elaboration-part-whole': 'Elaboration',
    u'elaboration-process-step': 'Elaboration',
    u'elaboration-set-member': 'Elaboration',
    u'elaborazioa': 'Elaboration',
    u'enablement': 'Enablement',
    u'evaluación': 'Evaluation',
    u'evaluation': 'Evaluation',
    u'evidence': 'Explanation',
    u'evidencia': 'Explanation',
    u'example': 'Elaboration',
    u'explanation': 'Explanation',
    u'explanation-argumentative': 'Explanation',
    u'ez-baldintzatzailea': 'Condition',
    u'fondo': 'Background',
    u'helburua': 'Enablement',
    u'hypothetical': 'Condition',
    u'interpretación': 'Evaluation',
    u'interpretation': 'Evaluation',
    u'interpretazioa': 'Evaluation',
    u'inverted-sequence': 'Temporal',
    u'joint': 'Joint',
    u'justificación': 'Explanation',
    u'justifikazioa': 'Explanation',
    u'justify': 'Explanation',
    u'kausa': 'Cause',
    u'konjuntzioa': 'Joint',
    u'kontrastea': 'Contrast',
    u'kontzesioa': 'Contrast',
    u'laburpena': 'Summary',
    u'list': 'Joint',
    u'lista': 'Joint',
    u'manner': 'Manner-Means',
    u'means': 'Manner-Means',
    u'medio': 'Manner-Means',
    u'metodoa': 'Manner-Means',
    u'motibazioa': 'Explanation',
    u'motivación': 'Explanation',
    u'motivation': 'Explanation',
    u'non-volitional-cause': 'Cause',
    u'non-volitional-result': 'Cause',
    u'nonvolitional-cause': 'Cause',
    u'nonvolitional-result': 'Cause',
    u'ondorioa': 'Cause',
    u'otherwise': 'Condition',
    u'parenthetical': 'Elaboration',
    u'preference': 'Comparison',
    u'preparación': 'Background',
    u'preparation': 'Background',
    u'prestatzea': 'Background',
    u'problem-solution': 'Topic-Comment',
    u'proportion': 'Comparison',
    u'propósito': 'Enablement',
    u'purpose': 'Enablement',
    u'question-answer': 'Topic-Comment',
    u'reason': 'Explanation',
    u'reformulación': 'Summary',
    u'restatement': 'Summary',
    u'restatement-mn': 'Summary',
    u'result': 'Cause',
    u'resultado': 'Cause',
    u'resumen': 'Summary',
    u'rhetorical-question': 'Topic-Comment',
    u'same-unit': 'Same-unit',
    u'secuencia': 'Temporal',
    u'sekuentzia': 'Temporal',
    u'sequence': 'Temporal',
    u'solución': 'Topic-Comment',
    u'solutionhood': 'Topic-Comment',
    u'statement-response': 'Topic-Comment',
    u'summary': 'Summary',
    u'temporal-after': 'Temporal',
    u'temporal-before': 'Temporal',
    u'temporal-same-time': 'Temporal',
    u'testuingurua': 'Background',
    u'textual-organization': 'Textual-organization',
    u'textualorganization': 'Textual-organization',
    u'topic-comment': 'Topic-Comment',
    u'topic-drift': 'Topic-Change',
    u'topic-shift': 'Topic-Change',
    u'unconditional': 'Condition',
    u'unión': 'Joint',
    u'unless': 'Condition',
    u'volitional-cause': 'Cause',
    u'volitional-result': 'Cause',
    u'zirkunstantzia': 'Background',
    u'question': 'Topic-Comment',  # Shi Ke added for gum dataset
}

# Dictionnaries with original labels as annotated in the data and possible
# corrections if needed (ie translation to English, correction of errors)

basque_labels = {
    u'ahalbideratzea': u'purpose',
    u'alderantzizko-baldintza': u'condition',
    u'antitesia': u'antithesis',
    u'arazo-soluzioa': u'solutionhood',  # solution-hood changed to 'solutionhood'
    u'aukera': u'otherwise',
    u'baldintza': u'condition',
    u'bateratzea': u'list',  # Join on the website but Joint is a most common name
    u'birformulazioa': u'restatement',
    u'definitu-gabeko-erlazioa': u'restatement',
    u'disjuntzioa': u'disjunction',
    u'ebaluazioa': u'evaluation',
    u'ebidentzia': u'evidence',
    u'elaborazioa': u'elaboration',
    u'ez-baldintzatzailea': u'condition',
    u'helburua': u'purpose',
    u'interpretazioa': u'interpretation',
    u'justifikazioa': u'justify',
    u'kausa': u'cause',
    u'konjuntzioa': u'conjunction',
    u'kontrastea': u'contrast',
    u'kontzesioa': u'concession',
    u'laburpena': u'summary',
    u'lista': u'list',
    u'metodoa': u'means',
    u'motibazioa': u'justify',
    u'ondorioa': u'result',
    u'prestatzea': u'preparation',
    u'same-unit': u'same-unit',
    u'sekuentzia': u'sequence',
    u'testuingurua': u'background',
    u'zirkunstantzia': u'circumstance'
}

brazilianCst_labels = {  # The most similar to the RST
    u'antithesis': u'antithesis',
    u'attribution': u'attribution',
    u'background': u'background',
    u'circumstance': u'circumstance',
    u'comparison': u'comparison',
    u'concession': u'concession',
    u'conclusion': u'conclusion',
    u'condition': u'condition',
    u'contrast': u'contrast',
    u'elaboration': u'elaboration',
    u'enablement': u'enablement',
    u'evaluation': u'evaluation',
    u'evidence': u'evidence',
    u'explanation': u'explanation',
    u'interpretation': u'interpretation',
    u'joint': u'joint',
    u'justify': u'justify',
    u'list': u'list',
    u'means': u'means',
    u'motivation': u'motivation',
    u'non-volitional-cause': u'non-volitional-cause',
    u'non-volitional-result': u'non-volitional-result',
    u'otherwise': u'otherwise',
    u'parenthetical': u'parenthetical',
    u'purpose': u'purpose',
    u'restatement': u'restatement',
    u'same-unit': u'same-unit',
    u'sequence': u'sequence',
    u'solutionhood': u'solutionhood',
    u'volitional-cause': u'volitional-cause',
    u'volitional-result': u'volitional-result'
}

brazilianSum_labels = {
    u'antithesis': u'antithesis',
    u'attribution': u'attribution',
    u'background': u'background',
    u'circumstance': u'circumstance',
    u'comparison': u'comparison',
    u'concession': u'concession',
    u'conclusion': u'conclusion',
    u'condition': u'condition',
    u'contrast': u'contrast',
    u'elaboration': u'elaboration',
    u'evaluation': u'evaluation',
    u'evidence': u'evidence',
    u'explanation': u'explanation',
    u'interpretation': u'interpretation',
    u'joint': u'joint',
    u'justify': u'justify',
    u'list': u'list',
    u'means': u'means',
    u'non-volitional-cause': u'non-volitional-cause',
    u'non-volitional-result': u'non-volitional-result',
    u'otherwise': u'otherwise',
    u'parenthetical': u'parenthetical',
    u'purpose': u'purpose',
    u'restatement': u'restatement',
    u'same-unit': u'same-unit',
    u'sequence': u'sequence',
    u'solutionhood': u'solutionhood',
    u'summary': u'summary',
    u'volitional-cause': u'volitional-cause'
}

brazilianTCC_labels = {
    u'antithesis': u'antithesis',
    u'attribution': u'attribution',
    u'background': u'background',
    u'circumstance': u'circumstance',
    u'comparison': u'comparison',
    u'concession': u'concession',
    u'conclusion': u'conclusion',
    u'condition': u'condition',
    u'contrast': u'contrast',
    u'elaboration': u'elaboration',
    u'enablement': u'enablement',
    u'evaluation': u'evaluation',
    u'evidence': u'evidence',
    u'explanation': u'explanation',
    u'interpretation': u'interpretation',
    u'joint': u'joint',
    u'justify': u'justify',
    u'list': u'list',
    u'means': u'means',
    u'motivation': u'motivation',
    u'non-volitional-cause': u'non-volitional-cause',
    u'non-volitional-result': u'non-volitional-result',
    u'otherwise': u'otherwise',
    u'parenthetical': u'parenthetical',
    u'purpose': u'purpose',
    u'restatement': u'restatement',
    u'same-unit': u'same-unit',
    u'sequence': u'sequence',
    u'solutionhood': u'solutionhood',
    u'summary': u'summary',
    u'volitional-cause': u'volitional-cause',
    u'volitional-result': u'volitional-result'
}

germanPcc_labels = {
    u'evaluation-n': u'evaluation',
    u'evaluation-s': u'evaluation',
    u'enablement': u'purpose',
    u'motivation': u'purpose',
    u'unless': u'condition',
    u'justify': u'reason',
    u'otherwise': u'condition',

}

spanish_labels = {
    u'alternativa': u'alternative',
    u'antítesis': u'antithesis',
    u'capacitación': u'enablement',
    u'causa': u'cause',
    u'circunstancia': u'circumstance',
    u'concesión': u'concession',
    u'condición': u'condition',
    u'condición-inversa': u'unconditional',
    u'conjunción': u'conjunction',
    u'contraste': u'contrast',
    u'disyunción': u'disjunction',
    u'elaboración': u'elaboration',
    u'evaluación': u'evaluation',
    u'evidencia': u'evidence',
    u'fondo': u'background',
    u'interpretación': u'interpretation',
    u'justificación': u'justify',
    u'lista': u'list',
    u'medio': u'means',
    u'motivación': u'motivation',
    u'preparación': u'preparation',
    u'propósito': u'purpose',
    u'reformulación': u'restatement',
    u'resultado': u'result',
    u'resumen': u'summary',
    u'same-unit': u'same-unit',
    u'secuencia': u'sequence',
    u'solución': u'solutionhood',
    u'unión': u'joint',
    u'unless': u'unless'
}

sctb_rel2class = {
    'enablement': 'purpose',
    'disjunction': 'list',
    'conjunction': 'list',
    'justify': 'purpose',
    'motivation': 'purpose',
}

nldt_labels = {
    u'nonvolitional-cause': u'non-volitional-causal',
    u'nonvolitional-result': u'non-volitional-causal',
    u'volitional-cause': u'volitional-causal',
    u'volitional-result': u'volitional-causal',
    u'restatement-mn': u'restatement',  # multinuclear version
    u'antithesis': u'adversative',  # only Antithesis_NN, not found in other corpora
    u'otherwise': u'condition',
    u'unconditional': u'condition',
    u'unless': u'condition'
}

annodis_labels = {
    u'explication': u'explanation',
    u'alternation': u'disjunction',
    u'but': u'purpose',
    u'goal': u'purpose',
    u'résultat': 'result',
    u'parallèle': 'conjunction',
    u'parallel': 'conjunction',
    u'contraste': 'contrast',
    u'conditionnel': 'condition',
    u'conditional': 'condition',
    u'arrière-plan': 'background',
    u'encadrement': 'frame',
    u'commentaire': 'topic-comment',
    u'comment': 'topic-comment',
    u'temploc': 'circumstance',
    u'explanation*': 'explanation',
    u'narration': 'sequence'
}

fas_labels = {
    'same': 'same-unit',
    'cause': 'causal',
    'causemult': 'causal',
    'comparisonmult': 'comparison',
    'conditionmult': 'condition',
    'contrastmult': 'contrast',
    'evaluationmult': 'evaluation',
    'jointmult': 'joint',
    'temporalmult': 'temporal',
    'textualorganizationmult': 'textualorganization',
    'topichange': 'topic-change',
    'topichangemult': 'topic-change',
    'topicomment': 'topic-comment',
    'topicommentmult': 'topic-comment',
    'topicdrift': 'topic-change',
    'topidrift': 'topic-change',
    'topicdriftmult': 'topic-change',
}

cstn_rel2class = {
    'volitional-cause': 'volitional-causal',
    'non-volitional-cause': 'volitional-causal',
    'volitional-result': 'volitional-causal',
    'non-volitional-result': 'volitional-causal',
    'volitional-result-e': 'volitional-causal',
    'non-volitional-result-e': 'non-volitional-causal',
    'volitional-cause-e': 'volitional-causal',
    'non-volitional-cause-e': 'non-volitional-causal',
    'evaluation': 'interpretation-evaluation',
    'conclusion': 'interpretation-evaluation',
    'otherwise': 'condition',
    'enablement': 'purpose',
    'joint': 'list',  # x2
    'interpretation': 'interpretation-evaluation',
}

umuc_rel2class = {
    'reason-s': 'Reason',
    'reason-n': 'Reason',
    'cause-s': 'Cause',
    'cause-n': 'Cause',
    'condition-s': 'Condition',
    'condition-n': 'Condition',
    'purpose-s': 'Purpose',
    'purpose-n': 'Purpose',
    'concession-s': 'Concession',
    'concession-n': 'Concession',
    'sameunit': 'Same-unit',
    'evaluation-n': 'Evaluation',
    'evaluation-s': 'Evaluation',
    'otherwise': 'Condition',
    'unless': 'Condition',
    'topic-comment': 'Interpretation',
    'enablement': 'Purpose'
}


def _invert_class2rel(class2rel: dict) -> dict:
    """Return relation to class mapping from a class2rel mapping."""
    rel2class = {}
    for cl, rels in class2rel.items():
        rel2class[cl.lower()] = cl
        for rel in rels:
            rel2class[rel] = cl
    return rel2class


# ---------------------------------------------------------------------------
#  Relation mappings for specific corpora
# ---------------------------------------------------------------------------

# RST-DT like relation set
rstdt_class2rel = {
    'Attribution': ['attribution', 'attribution-e', 'attribution-n', 'attribution-negative'],
    'Background': ['background', 'background-e', 'circumstance', 'circumstance-e'],
    'Causal': ['cause', 'cause-result', 'result', 'result-e', 'consequence', 'consequence-n-e',
              'consequence-n', 'consequence-s-e', 'consequence-s'],
    'Comparison': ['comparison', 'comparison-e', 'preference', 'preference-e', 'analogy', 'analogy-e',
                   'proportion'],
    'Condition': ['condition', 'condition-e', 'hypothetical', 'contingency', 'otherwise'],
    'Adversative': ['contrast', 'concession', 'concession-e', 'antithesis', 'antithesis-e'],
    'Elaboration': ['elaboration-additional', 'elaboration-additional-e', 'elaboration-general-specific-e',
                    'elaboration-general-specific', 'elaboration-part-whole', 'elaboration-part-whole-e',
                    'elaboration-process-step', 'elaboration-process-step-e',
                    'elaboration-object-attribute-e', 'elaboration-object-attribute',
                    'elaboration-set-member', 'elaboration-set-member-e', 'example', 'example-e',
                    'definition', 'definition-e'],
    'Enablement': ['purpose', 'purpose-e', 'enablement', 'enablement-e'],
    'Evaluation': ['evaluation', 'evaluation-n', 'evaluation-s-e', 'evaluation-s', 'interpretation-n',
                   'interpretation-s-e', 'interpretation-s', 'interpretation', 'conclusion', 'comment',
                   'comment-e', 'comment-topic'],
    'Explanation': ['evidence', 'evidence-e', 'explanation-argumentative', 'explanation-argumentative-e',
                    'reason', 'reason-e'],
    'Joint': ['list', 'disjunction'],
    'Manner-Means': ['manner', 'manner-e', 'means', 'means-e'],
    'Topic-Comment': ['problem-solution', 'problem-solution-n', 'problem-solution-s', 'question-answer',
                      'question-answer-n', 'question-answer-s', 'statement-response',
                      'statement-response-n', 'statement-response-s', 'topic-comment', 'comment-topic',
                      'rhetorical-question'],
    'Summary': ['summary', 'summary-n', 'summary-s', 'restatement', 'restatement-e'],
    'Temporal': ['temporal-before', 'temporal-before-e', 'temporal-after', 'temporal-after-e',
                 'temporal-same-time', 'temporal-same-time-e', 'sequence', 'inverted-sequence'],
    'Topic-Change': ['topic-shift', 'topic-drift'],
    'textual-organization': ['textualorganization'],
    'span': ['span'],
    'same-unit': ['same-unit']
}

rstdt_rel2class = _invert_class2rel(rstdt_class2rel)

# STS relation set
sts_class2rel = {
    'Attribution': ['attribution', 'attribution-e', 'attribution-n', ],
    'Cause': ['cause', 'volitional-cause', 'nonvolitional-cause'],
    'Result': ['result', 'volitional-result', 'nonvolitional-result'],
    'Condition': ['condition', 'condition-e', 'hypothetical', 'contingency', 'otherwise', 'unconditional'],
    'Enablement': ['purpose', 'purpose-e', 'enablement', 'enablement-e'],
    'Evaluation': ['evaluation', 'evaluation-n', 'evaluation-s-e', 'evaluation-s', 'interpretation-n',
                   'interpretation-s-e', 'interpretation-s', 'interpretation', 'conclusion', 'comment',
                   'comment-e', 'comment-topic'],
    'Evidence': ['evidence', 'evidence-e'],
    'Explanation': ['explanation-argumentative', 'explanation-argumentative-e'],
    'Joint': ['joint', 'conjunction', 'disjunction'],
    'Manner-Means': ['manner', 'manner-e', 'means', 'means-e'],
    'Topic-Comment': ['problem-solution', 'problem-solution-n', 'problem-solution-s', 'question-answer',
                      'question-answer-n', 'question-answer-s', 'statement-response',
                      'statement-response-n', 'statement-response-s', 'topic-comment', 'comment-topic',
                      'rhetorical-question', 'solutionhood'],
    'Summary': ['summary', 'summary-n', 'summary-s', 'restatement'],
    'Sequence': ['temporal-after', 'temporal-after-e', 'sequence'],
    'Circumstance': ['circumstance', 'circumstance-e'],
    'Concession': ['concession', 'concession-e'],
    'Antithesis': ['antithesis', 'antithesis-e', 'unless'],
    'Reason': ['reason', 'reason-e', 'motivation', 'justify'],
}

sts_rel2class = _invert_class2rel(sts_class2rel)

# Russian RRT-like relation set
rrt_class2rel = {
    'Background': ['background'],
    'Causal': ['cause', 'effect', 'cause-effect'],
    'Comparison': ['comparison'],
    'Concession': ['concession'],
    'Condition': ['condition', 'motivation'],
    'Contrast': ['contrast'],
    'Elaboration': ['elaboration'],
    'Preparation': ['preparation'],
    'Purpose': ['purpose'],
    'Interpretation-evaluation': ['evaluation', 'interpretation', 'interpretation-evaluation'],
    'Evidence': ['evidence'],
    'Joint': ['joint'],
    'Solutionhood': ['solutionhood'],
    'Restatement': ['restatement', 'conclusion'],
    'Sequence': ['sequence'],
    'span': ['span'],
    'same-unit': ['same-unit']
}

rrt_rel2class = _invert_class2rel(rrt_class2rel)

crdt_rel2class = {
    'evaluation-s': 'Evaluation',
    'reason-n': 'Reason',
    'restatement-m': 'Restatement',
    'concession-n': 'Concession',
    'evaluation-s': 'Evaluation',
    'evaluation-n': 'Evaluation',
    'unless': 'Condition',
    'otherwise': 'Condition',
    'summary': 'Restatement',
    'motivation': 'Purpose',
    'justify': 'Evidence',
    'disjunction': 'List',
    'enablement': 'Purpose',
    'antithesis': 'Contrast',
    'cause': 'Causal',
    'result': 'Causal',
    'circumstance': 'Background'
}
